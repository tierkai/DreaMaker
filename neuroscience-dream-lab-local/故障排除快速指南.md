# 神经梦境实验室 - 快速故障排除指南

## 🚀 快速启动

### 一键启动
```bash
# Linux/macOS
./start.sh

# Windows
start.bat
```

### 手动启动
```bash
# 1. 安装依赖
pnpm install

# 2. 配置环境变量
cp .env.example .env.local
# 编辑 .env.local 填入你的配置

# 3. 启动开发服务器
pnpm dev
```

## 🐛 常见问题解决

### 问题1: 依赖安装失败

**症状**: `npm install` 或 `pnpm install` 报错

**解决方案**:
```bash
# 清理缓存重新安装
rm -rf node_modules pnpm-lock.yaml package-lock.json
pnpm install
# 或
npm install
```

### 问题2: 端口5173被占用

**症状**: `Error: listen EADDRINUSE: address already in use :::5173`

**解决方案**:
```bash
# 查看端口占用
lsof -i :5173  # macOS/Linux
netstat -ano | findstr :5173  # Windows

# 杀死占用进程
kill -9 <PID>  # macOS/Linux
taskkill /PID <PID> /F  # Windows

# 或使用其他端口
pnpm dev --port 3000
```

### 问题3: Node.js版本过低

**症状**: `Node.js version is not supported`

**解决方案**:
```bash
# 检查当前版本
node --version

# 需要 Node.js 18+ 版本
# 下载地址: https://nodejs.org/
```

### 问题4: WebGL不支持

**症状**: 3D功能无法显示，页面空白

**解决方案**:
1. 检查浏览器是否支持WebGL 2.0
2. 更新显卡驱动
3. 启用硬件加速
4. 尝试不同浏览器

**检查方法**:
```javascript
// 在浏览器控制台运行
console.log(WebGLRenderingContext);
```

### 问题5: Supabase连接失败

**症状**: 用户认证、数据加载等功能异常

**解决方案**:
1. 检查 `.env.local` 配置
2. 确认 Supabase 项目状态
3. 验证 API 密钥有效性
4. 检查网络连接

**配置检查**:
```env
VITE_SUPABASE_URL=https://your-project.supabase.co
VITE_SUPABASE_ANON_KEY=your_anon_key
```

### 问题6: TypeScript编译错误

**症状**: TypeScript类型检查失败

**解决方案**:
```bash
# 重新生成类型
pnpm type-check --noEmit

# 或清理重新构建
rm -rf dist
pnpm build
```

### 问题7: 3D渲染性能问题

**症状**: 3D场景卡顿，帧率低

**解决方案**:
1. 降低3D渲染质量
```javascript
// 在浏览器控制台设置
localStorage.setItem('3D_QUALITY', 'low');
```

2. 关闭其他占用GPU的程序
3. 更新显卡驱动

### 问题8: AI沙龙功能无响应

**症状**: AI聊天界面无法发送消息

**解决方案**:
1. 检查 MiniMax API 配置
2. 验证 API 密钥有效性
3. 确认网络连接
4. 查看浏览器控制台错误

## 🔧 开发工具

### 浏览器开发者工具
- **F12** 打开开发者工具
- **Console** 查看错误信息
- **Network** 检查API请求
- **Performance** 分析性能

### React DevTools
- 安装 React Developer Tools 扩展
- 查看组件树和状态
- 分析组件渲染性能

### VS Code 扩展推荐
- TypeScript Importer
- ES7+ React/Redux/React-Native snippets
- Tailwind CSS IntelliSense
- Auto Rename Tag
- Prettier - Code formatter

## 📊 性能监控

### 启用性能监控
```javascript
// 在开发模式启用
if (import.meta.env.DEV) {
  import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {
    getCLS(console.log);
    getFID(console.log);
    getFCP(console.log);
    getLCP(console.log);
    getTTFB(console.log);
  });
}
```

### 内存使用检查
```javascript
// 在浏览器控制台运行
performance.memory.usedJSHeapSize / 1024 / 1024  // MB
```

## 🛠️ 调试技巧

### 1. 启用详细日志
```env
# 在 .env.local 中设置
VITE_DEBUG_LOGGING=true
```

### 2. React组件调试
```javascript
// 在组件中添加
console.log('Component rendered:', props);
```

### 3. API请求调试
```javascript
// 在 services 文件中添加
console.log('API Request:', url, options);
console.log('API Response:', response);
```

### 4. 3D场景调试
```javascript
// 在 Three.js 组件中添加
console.log('Scene objects:', scene.children);
console.log('Renderer info:', renderer.info);
```

## 📞 获取帮助

### 检查清单
- [ ] Node.js 版本 >= 18.0.0
- [ ] 包管理器安装正常
- [ ] 依赖安装成功
- [ ] .env.local 配置正确
- [ ] 端口5173未被占用
- [ ] 浏览器支持WebGL 2.0
- [ ] 网络连接正常

### 错误信息收集
提交问题时请提供：
1. 操作系统和版本
2. Node.js 版本
3. 浏览器类型和版本
4. 完整错误信息
5. 重现步骤
6. 期望结果

### 联系支持
- 查看 [完整安装运行指南](./本地安装运行指南.md)
- 检查项目 Issues
- 参考官方文档

---

*最后更新: 2025-10-31*  
*版本: v1.0*